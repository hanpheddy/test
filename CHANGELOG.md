Refactor codebase with Z [M6TjIw] line 5.2
